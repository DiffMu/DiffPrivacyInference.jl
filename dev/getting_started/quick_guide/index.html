<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quick Guide · DiffPrivacyInference</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DiffPrivacyInference</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../installation/">Installation</a></li><li class="is-active"><a class="tocitem" href>Quick Guide</a><ul class="internal"><li><a class="tocitem" href="#Supported-julia-syntax"><span>Supported <code>julia</code> syntax</span></a></li><li><a class="tocitem" href="#Forbidden-things"><span>Forbidden things</span></a></li><li><a class="tocitem" href="#Usage-examples"><span>Usage examples</span></a></li></ul></li></ul></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../../tutorial/01_sensitivity_functions/">Sensitivity functions</a></li><li><a class="tocitem" href="../../tutorial/02_privacy_functions/">Privacy functions</a></li></ul></li><li><span class="tocitem">Full Reference</span><ul><li><a class="tocitem" href="../../full_reference/types/">Types</a></li><li><a class="tocitem" href="../../full_reference/annotations/">Annotations</a></li><li><a class="tocitem" href="../../full_reference/builtins/">Builtins</a></li><li><a class="tocitem" href="../../full_reference/scoping_rules/">Scoping rules</a></li><li><a class="tocitem" href="../../full_reference/mutating_functions/">Mutating functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Getting Started</a></li><li class="is-active"><a href>Quick Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quick Guide</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DiffMu/DiffPrivacyInference.jl/blob/master/docs/src/getting_started/quick_guide.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quick-Guide"><a class="docs-heading-anchor" href="#Quick-Guide">Quick Guide</a><a id="Quick-Guide-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Guide" title="Permalink"></a></h1><h2 id="Supported-julia-syntax"><a class="docs-heading-anchor" href="#Supported-julia-syntax">Supported <code>julia</code> syntax</a><a id="Supported-julia-syntax-1"></a><a class="docs-heading-anchor-permalink" href="#Supported-julia-syntax" title="Permalink"></a></h2><p>We cannot check arbitrary <code>julia</code> code, instead we restrict to a subset of the language which is suited for our static analysis. Here&#39;s a list of language features we support at the moment:</p><ul><li>Function definitions using <code>function</code>, one-line definitions and anonymous functions, as well as function application.</li><li>Multiple dispatch on <code>Number, Integer, Real, Matrix{T}, Tuple{T}</code> and our special types (see below). Finer types are not allowed.</li><li>Some arithmetics on numbers, vectors and matrices, as well as indexing on matrix using <code>m[i,:]</code> and <code>m[i,j]</code> and vector indexing using <code>v[i]</code></li><li>Type annotations on function variables, like in <code>f(x::Integer) = x + x</code></li><li>Variable and tuple assignments like <code>x = 1</code> or <code>(a,b,c) = t</code></li><li>Loops over integer ranges, where the loop head must be of the form <code>for i in 1:2:n</code>.</li><li><code>if</code>, <code>ifelse</code> and <code>else</code> statements where the condition can be an integer or of the form <code>x == y</code>.</li><li><code>import</code>, which will just be ignored by the type checker. You can use stuff from imported modules, but only inside black boxes (see below).</li><li><code>include</code> statements. The typechecker will load the included file and check it as well.</li><li>Functions which mutate (some) of their arguments. Special rules apply, see <a href="../../full_reference/mutating_functions/#Mutating-functions">Mutating functions</a>.</li></ul><h2 id="Forbidden-things"><a class="docs-heading-anchor" href="#Forbidden-things">Forbidden things</a><a id="Forbidden-things-1"></a><a class="docs-heading-anchor-permalink" href="#Forbidden-things" title="Permalink"></a></h2><p>There are a few things you are not allowed to do (which the typechecker will tell you if you try). Namely:</p><ul><li>Your code has to be valid julia code. If it is not, do not expect the typechecker to always tell you so or produce reasonable results.</li><li>You cannot reassign (or mutate) variables that were declared in a different scope. For example, the following is illegal:<pre><code class="nohighlight hljs">function foo()
   x = 10
   function bar()
      x = 100
      x
   end
   bar()
end</code></pre></li><li>If you want to use a variable, you have to define it first. E.g. the following is valid julia code but illegal:<pre><code class="nohighlight hljs">function foo()
   bar() = a
   a = 100
   bar()
end</code></pre></li><li>As long a reassignment happens in the same scope as where the variable was defined, it is allowed. For example the following is valid code:<pre><code class="nohighlight hljs">function foo()
   x = 1
   y = x+2
   x = 2
   y
end</code></pre></li><li>For a detailed explanation see <a href="../../full_reference/scoping_rules/#Scoping-rules">Scoping rules</a>.</li><li>Recursion is not supported.</li><li>Assignments within assignments (like <code>x = y = 10</code>) are forbidden. Why would you, anyways.</li></ul><h3 id="Special-Types"><a class="docs-heading-anchor" href="#Special-Types">Special Types</a><a id="Special-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Special-Types" title="Permalink"></a></h3><p>We have two special types, <code>DMModel</code> for wrapping <code>Flux.jl</code> models and <code>DMGrads</code> for wrapping <code>Zygote.jl</code> gradients. If you want to typecheck code that uses an object like that, you need to wrap it in our types so we can ensure you don&#39;t do anything illegal with it. See the type documentation in the REPL and the <code>flux_dp.jl</code> example in <a href="https://github.com/DiffMu/DiffPrivacyInference.jl/tree/main/test/flux_dp"><code>test/flux_dp</code></a> for usage.</p><h3 id="Special-annotations"><a class="docs-heading-anchor" href="#Special-annotations">Special annotations</a><a id="Special-annotations-1"></a><a class="docs-heading-anchor-permalink" href="#Special-annotations" title="Permalink"></a></h3><p>In general, it is a good idea to annotate all function arguments as it will help the typechecker give you an inference result that is not too pessimistic and has a minimum number of unresolved constraints. There is, however, some special annotations that you should make to get a proper result:</p><ul><li>Our typechecker can infer the sensitivity or the (ε, δ)-differential privacy of function arguments. For every function you write, you have to tell the typechecker whether you expect it to be differentially private by annotating the function head using <code>function foo(x) :: Priv()</code>. If you don&#39;t annotate, the typechecker will assume that the function is not DP, which might worsen the inferred bounds if it&#39;s not true.</li><li>For differentially private functions, you can tell the typechecker which of its arguments are actually interesting. For example, when training a model to some data with some learning rate, you are interested in the privacy of the input data, not the input model. You would then write your function signature like this: <code>function train(data, model::NoData(), eta::NoData(Real))</code>. This allows the typecheker to infer tighter bounds by setting the privacy of non-interesting arguments to infinity in certain tradeoff situations.</li><li>If you write a function that takes a function as an argument, you have to decide whether you want that argument to be a privacy function or not, so we can do inference properly. You have to annotate the argument by <code>:: PrivacyFunction</code> if you want it to be a privacy function. If you don&#39;t, we assume it is not, and the typechecker will not permit putting a privacy function into that argument.</li><li>If you want to use a function that contains unsupported <code>julia</code> syntax, like using qualified names from imported modules, you can make them a <em>black box</em> by annotating the function head using <code>function foo(x) :: BlackBox()</code>. You can only define a black box on the toplevel scope of what you want to typecheck (not inside a function, e.g.). Also, black boxes cannot have multiple methods. The typechecker will ignore a black box&#39; function body and assign infinite sensitivity to all arguments. <em>Warning</em>: We cannot control what you do inside a black box, but the one thing that you really should not do is <em>mutate the arguments</em>. If you do that, the typechecking result will be invalid even though the typechecking code terminates without complaints.</li></ul><h2 id="Usage-examples"><a class="docs-heading-anchor" href="#Usage-examples">Usage examples</a><a id="Usage-examples-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-examples" title="Permalink"></a></h2><p>To infer the sensitivity of a simple function, use <code>typecheck_hs_from_string</code>:</p><pre><code class="nohighlight hljs">
julia&gt; typecheck_hs_from_string(&quot;function foo(x::Matrix{Real}, y::Matrix{Real})
                                    2*x - y
                                 end&quot;)</code></pre><p>The result will be printed in the REPL:</p><pre><code class="nohighlight hljs">---------------------------------------------------------------------------
Type:
Fun([([NoFun(Matrix&lt;n: τ_10, c: τ_8&gt;[s_5 × s_4](Num(τ_44[--]))) @ 2.0,NoFun(Matrix&lt;n: τ_10, c: τ_11&gt;[s_5 × s_4](Num(τ_38[--]))) @ 1] -&gt; NoFun(Matrix&lt;n: τ_10, c: U&gt;[s_5 × s_4](Num(τ_40[--])))) @ Just [Matrix{Real},Matrix{Real}]])
---------------------------------------------------------------------------
Constraints:
   - top:
constr_25 : [final,worst,global,exact,special] IsSupremum (τ_44,τ_38) :=: τ_40
   - others:
[]
()</code></pre><p>It says the checked code is a function (<code>Fun(...)</code>) of two arguments which is 2-sensitive in its first and 1-sensitive in its second input (indeicated by the <code>@ 2.0</code> annotation). The imput types both need to be matrices of matching dimensions (the variables <code>s_5</code> and <code>s_4</code>) whose elements are of some numeric type (<code>Num(...)</code>). But that is not quite all, as there is more output:</p><pre><code class="nohighlight hljs">- constraints:
   - top:
constr_25 : [final,worst,global,exact,special] IsSupremum (τ_44,τ_38) :=: τ_40</code></pre><p>It is the list of constraints on the type variables that occur in the result type that the typechecker could not resolve. In this case it tells us that the element type of the output matrix, <code>τ_40</code>, is not just any type, but the supremum of the input matrices&#39; element types <code>τ_44</code> and <code>τ_38</code>.</p><p>For a full-blown example head to the <a href="https://github.com/DiffMu/DiffPrivacyInference.jl/tree/main/test/flux_dp"><code>test/flux_dp</code></a> folder, where you will find a differentially private implementation of a gradient descent algorithm that is capable of learning to classify handwritten numbers.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../installation/">« Installation</a><a class="docs-footer-nextpage" href="../../tutorial/01_sensitivity_functions/">Sensitivity functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Thursday 17 March 2022 22:15">Thursday 17 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
