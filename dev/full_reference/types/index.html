<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Types · DiffPrivacyInference</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DiffPrivacyInference</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting_started/quick_guide/">Quick Guide</a></li></ul></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../../tutorial/01_sensitivity_functions/">Sensitivity functions</a></li><li><a class="tocitem" href="../../tutorial/02_privacy_functions/">Privacy functions</a></li><li><a class="tocitem" href="../../tutorial/03_flux_dp/">Learning MNIST using <code>Flux.jl</code>, verified differentially private</a></li></ul></li><li><span class="tocitem">User Reference</span><ul><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../syntax/">Supported julia syntax</a></li><li><a class="tocitem" href="../annotations/">Annotations</a></li><li><a class="tocitem" href="../builtins/">Builtins</a></li><li><a class="tocitem" href="../black_boxes/">Black Boxes</a></li><li><a class="tocitem" href="../demutation/">Mutation rules</a></li><li><a class="tocitem" href="../scoping_rules/">Scoping rules</a></li><li><a class="tocitem" href="../measuring_distance/">Measuring Distance</a></li><li class="is-active"><a class="tocitem" href>Types</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Base-types"><span>Base types</span></a></li><li><a class="tocitem" href="#Containers"><span>Containers</span></a></li><li><a class="tocitem" href="#Subtyping"><span>Subtyping</span></a></li></ul></li><li><a class="tocitem" href="../constraints/">Constraints</a></li></ul></li><li><span class="tocitem">Development Notes</span><ul><li><a class="tocitem" href="../../development_notes/updating_haskell/">Managing the two repositories</a></li><li><a class="tocitem" href="../../development_notes/project_structure/">Project structure</a></li><li><a class="tocitem" href="../../development_notes/technical_description/">Technical description</a></li><li><a class="tocitem" href="../../development_notes/demutation_system/">Demutation system</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Reference</a></li><li class="is-active"><a href>Types</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Types</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DiffMu/DiffPrivacyInference.jl/blob/master/docs/src/full_reference/types.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="types"><a class="docs-heading-anchor" href="#types">Types</a><a id="types-1"></a><a class="docs-heading-anchor-permalink" href="#types" title="Permalink"></a></h1><p>The privacy analysis result is presented to you as a type together with a collection of <a href="../constraints/#constraints">constraints</a>. You need to be able to read the types to understand it, so here&#39;s how.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Here&#39;s a list of all possible result types. See the below sections for more elaborate explanations.</p><table><tr><th style="text-align: left">DP type</th><th style="text-align: left">Description</th><th style="text-align: left">Function argument annotations</th><th style="text-align: left">Function annotations</th></tr><tr><td style="text-align: left"><code>Any</code></td><td style="text-align: left">Any type, like in julia</td><td style="text-align: left"><code>Any</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>Bool</code></td><td style="text-align: left">Booleans, like in julia</td><td style="text-align: left"><code>Bool</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>Integer</code></td><td style="text-align: left">Integers, like in julia</td><td style="text-align: left"><code>Integer</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>Real</code></td><td style="text-align: left">Reals, like in julia</td><td style="text-align: left"><code>Real</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>Data</code></td><td style="text-align: left">Reals, but measured with the discrete metric</td><td style="text-align: left"><code>Data</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>τ[s ©]</code></td><td style="text-align: left">static number of type <code>τ</code> with value <code>s</code></td><td style="text-align: left"><code>Static(τ)</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>τ[s]</code></td><td style="text-align: left">number of type <code>τ</code> where it is unknown whether it&#39;s static or not</td><td style="text-align: left"></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>(τ₁ @ s₁, ...) -&gt; τ</code></td><td style="text-align: left">sensitivity function mapping types <code>τ₁,...</code> to  <code>τ</code> with sensitivities <code>s₁,...</code></td><td style="text-align: left"><code>Function</code></td><td style="text-align: left">none</td></tr><tr><td style="text-align: left"><code>(τ₁ @ (e₁,d₁), ...) -&gt;* τ</code></td><td style="text-align: left">privacy function mapping types <code>τ₁,...</code> to  <code>τ</code> with privacies <code>(e₁,d₁),...</code></td><td style="text-align: left"><code>PrivacyFunction</code></td><td style="text-align: left"><code>Priv()</code></td></tr><tr><td style="text-align: left"><code>BlackBox[τ₁,...]</code></td><td style="text-align: left">Black box function with julia type signature <code>[τ₁,...]</code></td><td style="text-align: left"></td><td style="text-align: left"><code>BlackBox()</code></td></tr><tr><td style="text-align: left"><code>Tuple{τ₁,...}</code></td><td style="text-align: left">Tuple, like in julia</td><td style="text-align: left"><code>Tuple{τ₁,...}</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>Matrix&lt;n: N, c: C&gt;[s × t]{τ}</code></td><td style="text-align: left"><code>s×t</code>-Matrix with elements of type <code>τ</code>, measured in norm <code>N</code>, <code>C</code>-norm of each row bounded by 1</td><td style="text-align: left"><code>Matrix{τ}</code> or <code>MetricMatrix(N,τ)</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>Vector&lt;n: N, c: C&gt;[s]{τ}</code></td><td style="text-align: left">Row vector with <code>s</code> elements of type <code>τ</code>, measured in norm <code>N</code>, its <code>C</code>-norm bounded by 1</td><td style="text-align: left"><code>Vector{τ}</code> or <code>MetricVector(N,τ)</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>DMGrads&lt;n: N, c: C&gt;[s]{τ}</code></td><td style="text-align: left"><code>Zygote.jl</code> gradient with <code>s</code> elements of type <code>τ</code>, measured in norm <code>N</code>, its <code>C</code>-norm bounded by 1</td><td style="text-align: left"><code>DMGrads</code> or <code>MetricGradient(N,τ)</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>DMContainer&lt;kind: K, n: N, c: C&gt;[s]{τ}</code></td><td style="text-align: left">One of the above three container types (namely <code>K</code>) with <code>s</code> elements of type <code>τ</code>, measured in norm <code>N</code>, its <code>C</code>-norm bounded by 1</td><td style="text-align: left"></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>DMModel{τ}</code></td><td style="text-align: left"><code>Flux.jl</code> model with parameter type <code>τ</code></td><td style="text-align: left"><code>DMModel</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>τ₁ ∧ τ₂</code></td><td style="text-align: left">Infimum type of <code>τ₁</code> and <code>τ₂</code> w.r.t. subtyping, i.e. the &quot;largest&quot; type <code>τ</code> s.t. <code>τ₁ ⊑ τ</code> and <code>τ₂ ⊑ τ</code></td><td style="text-align: left"></td><td style="text-align: left"></td></tr></table><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><p>Function types carry the information you&#39;re probably most interested in, namely the inferred sensitivity or differential privacy of the function arguments. There are two sorts of functions, <a href="../../tutorial/01_sensitivity_functions/#sensitivity-functions">sensitivity functions</a> and <a href="../../tutorial/02_privacy_functions/#privacy-functions">privacy functions</a>.</p><h3 id="Sensitivity-functions"><a class="docs-heading-anchor" href="#Sensitivity-functions">Sensitivity functions</a><a id="Sensitivity-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Sensitivity-functions" title="Permalink"></a></h3><p>Functions that do not employ any differential privacy mechanisms have this type. It is denoted like this:</p><pre><code class="nohighlight hljs"> (τ₄ @ 0, τ @ s₁) -&gt; Integer[2.0 ©]</code></pre><p>The part before the <code>-&gt;</code> is the list of argument types this function admits, together with the inferred <a href="https://en.wikipedia.org/wiki/Differential_privacy#Sensitivity">sensitivity</a> annotated with the <code>@</code> symbol. Hence this tells us the typechecker inferred the function to be <code>0</code>-sensitive in its first and <code>s₁</code>-sensitivie in it&#39;s second input. It outputs the number <code>2</code>.</p><h3 id="Privacy-functions"><a class="docs-heading-anchor" href="#Privacy-functions">Privacy functions</a><a id="Privacy-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Privacy-functions" title="Permalink"></a></h3><p>Functions that do use one of the <a href="../builtins/#builtin-privacy-mechanisms">builtin privacy mechanisms</a> or use other functions that do are called <em>privacy functions</em>. The typechecker can infer their <a href="https://en.wikipedia.org/wiki/Differential_privacy">(ε, δ)-differential privacy</a> parameters. The result looks like this:</p><pre><code class="nohighlight hljs">{
|   - τ₅[s ©] @ (0, 0)
|
|   - Matrix&lt;n: L2, c: τ₂&gt;[s₃ × s₂]{τ₃₄}
|       @ (s, 0)
|   --------------------------
|    -&gt;* Matrix&lt;n: LInf, c: U&gt;[s₃ × s₂]{Real}
}</code></pre><p>It was inferred that the input julia code describes a <a href="../../tutorial/02_privacy_functions/#privacy-functions">privacy function</a> (denoted by <code>-&gt;*</code>) that maps some number with value <code>s</code> and some <code>s₃ × s₂</code>-dimensional matrix with elements of type <code>τ₃₄</code> to a <code>s₃ × s₂</code>-dimensional matrix with <code>Real</code> entries. The inferred privacy of the arguments is <code>(0,0)</code> and <code>(s,0)</code> respectively.</p><h2 id="Base-types"><a class="docs-heading-anchor" href="#Base-types">Base types</a><a id="Base-types-1"></a><a class="docs-heading-anchor-permalink" href="#Base-types" title="Permalink"></a></h2><h3 id="Numbers"><a class="docs-heading-anchor" href="#Numbers">Numbers</a><a id="Numbers-1"></a><a class="docs-heading-anchor-permalink" href="#Numbers" title="Permalink"></a></h3><p>The typechecker can discern between <code>Integer</code> and <code>Real</code> number types. Julia number types finer than that are not permitted. The typechecker however makes another distinction, namely between static and non-static numbers. A variable with a static number type is one in whose sensitivity/privacy we are not interested and whose value is instead used to express the sensitivity/privacy of other variables. A static real number with variable value <code>s</code> is denoted like this:</p><pre><code class="nohighlight hljs">Real[s ©]</code></pre><p>An example are the <code>eps</code> and <code>del</code> parameters of the <a href="../builtins/#DiffPrivacyInference.gaussian_mechanism-Tuple{Real, Real, Real, Any}"><code>gaussian_mechanism</code></a> function: you are interested in its privacy with respect to the values of these parameters.</p><pre><code class="language-julia hljs">julia&gt; typecheck_from_string(&quot;
       module L
       function f(eps::Static(), del::Static(), x::Matrix) :: Priv()
         gaussian_mechanism(1, eps, d, x)
       end
       end&quot;)
---------------------------------------------------------------------------
Type:
{
|   - τ₅[eps ©]@(0, 0)
|   
|   - τ₇[del ©]@(0, 0)
|   
|   - Matrix&lt;n: L2, c: τ₂&gt;[s₄ × s₃]{τ₃₈}
|       @ (eps, del)
|   --------------------------
|    -&gt;* Matrix&lt;n: LInf, c: U&gt;[s₄ × s₃]{Real}
}
(...)</code></pre><p>The privacy of the <code>x</code> argument is expressed in terms of the <code>eps</code> and <code>del</code> arguments. Note how you can <a href="../annotations/#annotations">annotate</a> numeric variables if you want them to be static.</p><h3 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h3><p>The sensitivity of a function is given with respect to a metric on the input and output spaces of the function. The typechecker supports two metrics on numbers, namely the euclidean metric <code>d(x,y) = |x-y|</code> and the discrete metric <code>d(x,y) = 0 if x==y, 1 otherwise</code>. If you want to use the latter, annotate your variables with <code>Data</code>:`</p><pre><code class="language-julia hljs">julia&gt; typecheck_from_string(&quot;module L
       function f(x::Data)
          disc(100.0) * x
       end
       end&quot;)
---------------------------------------------------------------------------
Type:
{
|   (Data @ 1) -&gt; Data
}</code></pre><p>Note that you have to use the <a href="full_reference/@ref"><code>disc</code></a> function to tell the typechecker that the scalar <code>100.0</code> should be measured in the discrete metric as well.</p><p>See the <a href="../measuring_distance/#measuring-distance">documentation on metrics</a> for more detailed information on how we measure distance.</p><h2 id="Containers"><a class="docs-heading-anchor" href="#Containers">Containers</a><a id="Containers-1"></a><a class="docs-heading-anchor-permalink" href="#Containers" title="Permalink"></a></h2><p>Our matrix/vector types have some more parameters than native julia matrices. They look like this:</p><pre><code class="nohighlight hljs">Matrix&lt;n: N, c: C&gt;[m × n]{T}
Vector&lt;n: N, c: C&gt;[m]{T}</code></pre><p>The types know about:</p><ul><li>the metric that is used to measure distance between two instances (<code>N</code> is one of <code>L1, L2, LInf</code>)</li><li>if their rows are bounded by <code>1</code> in some norm (<code>C</code> is one of <code>L1, L2, LInf, U</code> where <code>U</code> means unbounded row norm)</li><li>what dimension they have (<code>m × n</code> resp. <code>n</code>)</li><li>and what type their entries have (<code>T</code>)</li></ul><p>You can specify the norm and element type of a matrix or vector using the type functions <a href="../builtins/#DiffPrivacyInference.MetricMatrix-Tuple{Any, Float64}"><code>MetricMatrix</code></a> and <a href="../builtins/#DiffPrivacyInference.MetricVector-Tuple{Any, Float64}"><code>MetricVector</code></a>. The dimensions and row clip parameter are inferred.</p><p>See the <a href="../measuring_distance/#measuring-distance">documentation on metrics</a> for more detailed information on how we measure distance.</p><h3 id="Special-types-for-Flux.jl"><a class="docs-heading-anchor" href="#Special-types-for-Flux.jl">Special types for <code>Flux.jl</code></a><a id="Special-types-for-Flux.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Special-types-for-Flux.jl" title="Permalink"></a></h3><p>For compatibility with <a href="https://fluxml.ai/Flux.jl/stable/"><code>Flux.jl</code></a>, we have two special types:</p><ul><li><code>DMModel[m]</code> is the type of <code>Flux.jl</code> models with <code>m</code> parameters.</li><li><code>DMGrads&lt;n:N, c:C&gt;[m]{T}</code> is the type of <a href="https://fluxml.ai/Zygote.jl/stable/"><code>Zygote.jl</code></a> gradients measured in metric <code>N</code>, with bounded <code>C</code>-norm and <code>m</code> parameters of type <code>T</code>. Specify the matric using <a href="../builtins/#DiffPrivacyInference.MetricGradient-Tuple{Any, Float64}"><code>MetricGradient</code></a></li></ul><p>See the <a href="../../tutorial/03_flux_dp/#fluxdp">example implementation of DP-SGD</a> for usage examples of these.</p><h2 id="Subtyping"><a class="docs-heading-anchor" href="#Subtyping">Subtyping</a><a id="Subtyping-1"></a><a class="docs-heading-anchor-permalink" href="#Subtyping" title="Permalink"></a></h2><p>The subtyping hierarchy builds on the usual julia type hierarchy. That is, we have</p><p><code>Integer ⊑ Real</code></p><p>and</p><p><code>T ⊑ Any</code></p><p>for all types <code>T</code>, as well as <code>Tuple{τ₁,...} ⊑ Tuple{τ&#39;₁,...}</code> if and only if <code>τ₁⊑ τ&#39;₁...</code>. This extends to our static numbers, i.e. <code>τ₁[s]  ⊑ τ₂</code> <code>τ₁[s]  ⊑ τ₂[s]</code> if and only if <code>τ₁  ⊑ τ₂</code>, as well as to our custom container types, i.e. <code>DMContainer&lt;kind: K, n: N, c: C&gt;[s]{τ₁} ⊑ DMContainer&lt;kind: K, n: N, c: C&gt;[s]{τ₂}</code> if and only if <code>τ₁  ⊑ τ₂</code>.</p><p>Note that there are no other subtyping relations between our types. In particular, <code>Real</code> and <code>Data</code> are not in any subtyping relation, and there are no subtyping relations between functions.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../measuring_distance/">« Measuring Distance</a><a class="docs-footer-nextpage" href="../constraints/">Constraints »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.17 on <span class="colophon-date" title="Thursday 12 May 2022 11:45">Thursday 12 May 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
