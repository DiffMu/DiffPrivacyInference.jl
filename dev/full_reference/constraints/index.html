<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Constraints · DiffPrivacyInference</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DiffPrivacyInference</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting_started/quick_guide/">Quick Guide</a></li></ul></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../../tutorial/01_sensitivity_functions/">Sensitivity functions</a></li><li><a class="tocitem" href="../../tutorial/02_privacy_functions/">Privacy functions</a></li><li><a class="tocitem" href="../../tutorial/03_flux_dp/">Learning MNIST using <code>Flux.jl</code>, verified differentially private</a></li></ul></li><li><span class="tocitem">User Reference</span><ul><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../syntax/">Supported julia syntax</a></li><li><a class="tocitem" href="../annotations/">Annotations</a></li><li><a class="tocitem" href="../builtins/">Builtins</a></li><li><a class="tocitem" href="../black_boxes/">Black Boxes</a></li><li><a class="tocitem" href="../demutation/">Mutation rules</a></li><li><a class="tocitem" href="../scoping_rules/">Scoping rules</a></li><li><a class="tocitem" href="../measuring_distance/">Measuring Distance</a></li><li><a class="tocitem" href="../types/">Types</a></li><li class="is-active"><a class="tocitem" href>Constraints</a><ul class="internal"><li><a class="tocitem" href="#Equality-and-inequality"><span>Equality and inequality</span></a></li><li><a class="tocitem" href="#Const/NonConst"><span>Const/NonConst</span></a></li><li><a class="tocitem" href="#Choices/Mulitple-Dispatch-(IsChoice)"><span>Choices/Mulitple Dispatch (<code>IsChoice</code>)</span></a></li><li><a class="tocitem" href="#Arithmetic-operations-(IsTypeOpResult)"><span>Arithmetic operations (<code>IsTypeOpResult</code>)</span></a></li><li><a class="tocitem" href="#Julia-Types"><span>Julia Types</span></a></li><li><a class="tocitem" href="#Loops-(IsLoopResult)"><span>Loops (<code>IsLoopResult</code>)</span></a></li><li><a class="tocitem" href="#Additive-noise-mechanisms-(IsAdditiveNoiseResult)"><span>Additive noise mechanisms (<code>IsAdditiveNoiseResult</code>)</span></a></li><li><a class="tocitem" href="#Black-Boxes"><span>Black Boxes</span></a></li><li><a class="tocitem" href="#Container-types"><span>Container types</span></a></li></ul></li></ul></li><li><span class="tocitem">Development Notes</span><ul><li><a class="tocitem" href="../../development_notes/updating_haskell/">Managing the two repositories</a></li><li><a class="tocitem" href="../../development_notes/project_structure/">Project structure</a></li><li><a class="tocitem" href="../../development_notes/technical_description/">Technical description</a></li><li><a class="tocitem" href="../../development_notes/demutation_system/">Demutation system</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Reference</a></li><li class="is-active"><a href>Constraints</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Constraints</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DiffMu/DiffPrivacyInference.jl/blob/master/docs/src/full_reference/constraints.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="constraints"><a class="docs-heading-anchor" href="#constraints">Constraints</a><a id="constraints-1"></a><a class="docs-heading-anchor-permalink" href="#constraints" title="Permalink"></a></h1><p>The typechecker gives you the result of the privacy analysis of your julia code in form of <a href="../types/#types">Types</a> that usually contains variables of two kinds, namely type variables and number variables. The analysis result holds as long as you choose the values for these variables in a way that does not violate any of the constraints that also belong to the typechecking result. There is a variety of constraints, here&#39;s a list:</p><h2 id="Equality-and-inequality"><a class="docs-heading-anchor" href="#Equality-and-inequality">Equality and inequality</a><a id="Equality-and-inequality-1"></a><a class="docs-heading-anchor-permalink" href="#Equality-and-inequality" title="Permalink"></a></h2><h3 id="IsEqual"><a class="docs-heading-anchor" href="#IsEqual"><code>IsEqual</code></a><a id="IsEqual-1"></a><a class="docs-heading-anchor-permalink" href="#IsEqual" title="Permalink"></a></h3><pre><code class="nohighlight hljs">constr : constr  :  τ₁ and  τ must be equal</code></pre><p>The variables must be equal, i.e. describe the same type (for type variables) or have the same value (for number variables).</p><h3 id="IsLess-and-IsLessEqual"><a class="docs-heading-anchor" href="#IsLess-and-IsLessEqual"><code>IsLess</code> and <code>IsLessEqual</code></a><a id="IsLess-and-IsLessEqual-1"></a><a class="docs-heading-anchor-permalink" href="#IsLess-and-IsLessEqual" title="Permalink"></a></h3><pre><code class="nohighlight hljs">constr : constr₁  : eps &lt; 1
constr₂ : 0 ≤ eps</code></pre><p>The (numeric) variable <code>eps</code> must be in <code>[0,1)</code>.</p><pre><code class="nohighlight hljs">constr : τ ⊑ Real</code></pre><p>The type variable <code>τ</code> must be a <a href="https://diffmu.github.io/DiffPrivacyInference.jl/dev/full_reference/types/#Subtyping">subtype</a> of <code>Real</code>.</p><h3 id="IsSupremum-and-IsInfimum"><a class="docs-heading-anchor" href="#IsSupremum-and-IsInfimum"><code>IsSupremum</code> and <code>IsInfimum</code></a><a id="IsSupremum-and-IsInfimum-1"></a><a class="docs-heading-anchor-permalink" href="#IsSupremum-and-IsInfimum" title="Permalink"></a></h3><pre><code class="nohighlight hljs">constr : constr : Type τ₁ is the supremum of types τ₂ and Integer
constr : Type τ₃ is the infimum of types τ₄ and Real</code></pre><p>Suprema and infima w.r.t. the <a href="https://diffmu.github.io/DiffPrivacyInference.jl/dev/full_reference/types/#Subtyping">subtyping hierarchy</a>. That is, <code>τ₁</code> is the type that is lowest in the subtyping hierarchy such that <code>τ₂ ⊑ τ₁</code> and <code>Integer ⊑ τ₁</code></p><h2 id="Const/NonConst"><a class="docs-heading-anchor" href="#Const/NonConst">Const/NonConst</a><a id="Const/NonConst-1"></a><a class="docs-heading-anchor-permalink" href="#Const/NonConst" title="Permalink"></a></h2><p>We support <a href="../types/#types">static number types</a>, so we need constraints on whether a number type is static or not.</p><h3 id="MakeConst"><a class="docs-heading-anchor" href="#MakeConst"><code>MakeConst</code></a><a id="MakeConst-1"></a><a class="docs-heading-anchor-permalink" href="#MakeConst" title="Permalink"></a></h3><pre><code class="nohighlight hljs">If type τ is numeric or a tuple, it can become static</code></pre><p>All numeric types in <code>τ</code> will be set to static once they are known.</p><h3 id="MakeNonConst"><a class="docs-heading-anchor" href="#MakeNonConst"><code>MakeNonConst</code></a><a id="MakeNonConst-1"></a><a class="docs-heading-anchor-permalink" href="#MakeNonConst" title="Permalink"></a></h3><pre><code class="nohighlight hljs">All Numeric types in τ will be set non-static</code></pre><p>All numeric types in <code>τ</code> will be set to non-static once they are known.</p><h3 id="UnifyWithConstSubtype"><a class="docs-heading-anchor" href="#UnifyWithConstSubtype"><code>UnifyWithConstSubtype</code></a><a id="UnifyWithConstSubtype-1"></a><a class="docs-heading-anchor-permalink" href="#UnifyWithConstSubtype" title="Permalink"></a></h3><pre><code class="nohighlight hljs">constr : constr : Types τ₁ and τ₂ are equal except for static-ness, where the fist is a subtype of the second</code></pre><p>In case <code>τ₁ = τ[s ©]</code> is a <a href="../types/#types">static number</a> for some <code>s</code>, we allow <a href="https://diffmu.github.io/DiffPrivacyInference.jl/dev/full_reference/types/#Subtyping"><code>τ₁ ⊑ τ₂</code></a>. Otherwise, it is <code>τ₁ = τ₂</code>.</p><h2 id="Choices/Mulitple-Dispatch-(IsChoice)"><a class="docs-heading-anchor" href="#Choices/Mulitple-Dispatch-(IsChoice)">Choices/Mulitple Dispatch (<code>IsChoice</code>)</a><a id="Choices/Mulitple-Dispatch-(IsChoice)-1"></a><a class="docs-heading-anchor-permalink" href="#Choices/Mulitple-Dispatch-(IsChoice)" title="Permalink"></a></h2><p>If the julia type information is not sufficient to resolve multiple dispatch, you end up with constraints instead. Behold the following example, where the function <code>f</code> has two methods, but in the call to <code>f</code> that happens withing <code>g</code>, it is not yet clear which of the methods will be called. Annotating the argument of <code>g</code> would have made it possible to resolve the constraint, so it is advisable to add annotations where possible.</p><pre><code class="nohighlight hljs">julia&gt; typecheck_from_string(&quot;module L
       f(x::Matrix) = x+x
       f(x::Integer) = 2*x
       g(x) = f(x)
       end&quot;)

---------------------------------------------------------------------------
Type:
{
|   (τ₁₃ @ s₈) -&gt; τ₁₄
}

---------------------------------------------------------------------------
Constraints:
constr : Function types 
  {
  |   (τ₁₃ @ s₈) -&gt; τ₁₄
  }
 are required to exist among the following choices:
  - julia signature [Matrix{&lt;:Any}]: 
    {
    |   - Matrix&lt;n: τ₈, c: τ₉&gt;[s₅ × s₄]{τ₅₁}
    |       @ 2.0
    |   --------------------------
    |    -&gt; Matrix&lt;n: τ₈, c: U&gt;[s₅ × s₄]{τ₅₁}
    }
  
  - julia signature [Integer]: 
    {
    |   (Integer @ 2.0) -&gt; Integer
    }</code></pre><h2 id="Arithmetic-operations-(IsTypeOpResult)"><a class="docs-heading-anchor" href="#Arithmetic-operations-(IsTypeOpResult)">Arithmetic operations (<code>IsTypeOpResult</code>)</a><a id="Arithmetic-operations-(IsTypeOpResult)-1"></a><a class="docs-heading-anchor-permalink" href="#Arithmetic-operations-(IsTypeOpResult)" title="Permalink"></a></h2><p>Arithemtic operations like addition and multiplication have different sensitivities depending on the types of the operand. On the one hand, arithmetics on matrices behaves different from that on numbers, on the other hand we support <a href="../types/#types">static types</a> which behave like constant numbers. For example, the expression <code>s * x</code> is infinitely sensitive in both <code>s</code> and <code>x</code>, but if we assume <code>s</code> to be of static type, it is 0-sensitive in <code>s</code> and <code>s</code>-sensitive in <code>x</code>. This results in a constraint if the static-ness of the operands is unknown:</p><pre><code class="nohighlight hljs">constr : Binary operation * on (τ_s @ s₄, τ_x @ s₁) with result type τ₂</code></pre><p>Scalars <code>s₄</code> and <code>s₁</code> denote the sensitivities of the operands and will be set once the static-ness of <code>τ_s</code> and <code>τ_x</code> is determined. The possible operations are <code>+,-,*,/,mod,==,ceil</code>. Refer to page 36 of the <a href="https://arxiv.org/abs/1909.02481">duet paper</a> for reference on the sensitivity of these operations.</p><h2 id="Julia-Types"><a class="docs-heading-anchor" href="#Julia-Types">Julia Types</a><a id="Julia-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Julia-Types" title="Permalink"></a></h2><h3 id="IsJuliaEqual"><a class="docs-heading-anchor" href="#IsJuliaEqual"><code>IsJuliaEqual</code></a><a id="IsJuliaEqual-1"></a><a class="docs-heading-anchor-permalink" href="#IsJuliaEqual" title="Permalink"></a></h3><pre><code class="nohighlight hljs">constr : Types τ₁ and τ₂ describe the same julia type</code></pre><p>As you can read in the documentation on our <a href="../types/#types">types</a>, in addition to the supported julia types we use some refinements. For example, our function types contain information about argument and return types (as well as sensitivity/privacy, of course), while the only type julia provides for functions is <code>Function</code>. Other examples are static number types, container types that have information about dimension and metric. This constraint requires the julia representation of two types to be indistinguishable, while they might not be equal.</p><h3 id="IsFunction"><a class="docs-heading-anchor" href="#IsFunction"><code>IsFunction</code></a><a id="IsFunction-1"></a><a class="docs-heading-anchor-permalink" href="#IsFunction" title="Permalink"></a></h3><pre><code class="nohighlight hljs">Type τ is a k-function</code></pre><p><code>τ</code> must be some function type of kind <code>k</code> where <code>k</code> is either <code>SensitivityK</code> or <code>PrivacyK</code> (not a black box function, though).</p><h2 id="Loops-(IsLoopResult)"><a class="docs-heading-anchor" href="#Loops-(IsLoopResult)">Loops (<code>IsLoopResult</code>)</a><a id="Loops-(IsLoopResult)-1"></a><a class="docs-heading-anchor-permalink" href="#Loops-(IsLoopResult)" title="Permalink"></a></h2><pre><code class="nohighlight hljs">constr : Sensitivities (s₃, s₄, s₅) are dependant on whether number of iterations in τ₁:τ₂:τ₃ is static. Loop body has sensitivity s₉</code></pre><p>If a loop has a static number of iterations, we can give better sensitivity bounds. If the static-ness remains unknown, you end up with a constraint like this. Page 42 of the <a href="https://arxiv.org/abs/1909.02481">duet paper</a> has detailed rules on how the sensitivities will be resolved in case of static/non-static number of iterations. If you know the number of iterations is static, consider <a href="../annotations/#annotations">annotating</a> the relevant variables to avoid unresolved constraints of this kind.</p><h2 id="Additive-noise-mechanisms-(IsAdditiveNoiseResult)"><a class="docs-heading-anchor" href="#Additive-noise-mechanisms-(IsAdditiveNoiseResult)">Additive noise mechanisms (<code>IsAdditiveNoiseResult</code>)</a><a id="Additive-noise-mechanisms-(IsAdditiveNoiseResult)-1"></a><a class="docs-heading-anchor-permalink" href="#Additive-noise-mechanisms-(IsAdditiveNoiseResult)" title="Permalink"></a></h2><pre><code class="nohighlight hljs">Type τ₁ is the result of an additive noise mechanism executed on τ₂</code></pre><p>We provide additive noise mechanisms on numbers and matrices, where they result in different differential privacy. As long as the input type is not known, this constraint remains.</p><h2 id="Black-Boxes"><a class="docs-heading-anchor" href="#Black-Boxes">Black Boxes</a><a id="Black-Boxes-1"></a><a class="docs-heading-anchor-permalink" href="#Black-Boxes" title="Permalink"></a></h2><h3 id="IsBlackBox"><a class="docs-heading-anchor" href="#IsBlackBox"><code>IsBlackBox</code></a><a id="IsBlackBox-1"></a><a class="docs-heading-anchor-permalink" href="#IsBlackBox" title="Permalink"></a></h3><pre><code class="nohighlight hljs">constr : Black box function τ is applied to arguments [τ₁,...] </code></pre><p>The only things the typechecker knows about <a href="../black_boxes/#black-boxes">black box functions</a> is their name and the julia signature of the arguments. This constraint makes sure the signature matches the types of what the function was applied to.</p><h3 id="IsBlackBoxReturn"><a class="docs-heading-anchor" href="#IsBlackBoxReturn"><code>IsBlackBoxReturn</code></a><a id="IsBlackBoxReturn-1"></a><a class="docs-heading-anchor-permalink" href="#IsBlackBoxReturn" title="Permalink"></a></h3><pre><code class="nohighlight hljs">constr : Type τ₁ is an argument of a black box, its sensitivity s₁ can be set accordingly</code></pre><p>With some combination of input and output types of a black box, the typechecker can infer better privacy bounds. See the documentation on <a href="../black_boxes/#black-boxes">black boxes</a> for details.</p><h2 id="Container-types"><a class="docs-heading-anchor" href="#Container-types">Container types</a><a id="Container-types-1"></a><a class="docs-heading-anchor-permalink" href="#Container-types" title="Permalink"></a></h2><h3 id="IsVecOrMat"><a class="docs-heading-anchor" href="#IsVecOrMat"><code>IsVecOrMat</code></a><a id="IsVecOrMat-1"></a><a class="docs-heading-anchor-permalink" href="#IsVecOrMat" title="Permalink"></a></h3><pre><code class="nohighlight hljs">Type τ must be a vector or matrix</code></pre><h3 id="IsVecLike"><a class="docs-heading-anchor" href="#IsVecLike"><code>IsVecLike</code></a><a id="IsVecLike-1"></a><a class="docs-heading-anchor-permalink" href="#IsVecLike" title="Permalink"></a></h3><pre><code class="nohighlight hljs">Type τ must be a vector, gradient or one-row matrix</code></pre><h3 id="ConversionResult"><a class="docs-heading-anchor" href="#ConversionResult"><code>ConversionResult</code></a><a id="ConversionResult-1"></a><a class="docs-heading-anchor-permalink" href="#ConversionResult" title="Permalink"></a></h3><pre><code class="nohighlight hljs">constr : Converted norm n to norm m on an r-row container, incurring conversion penalty is p</code></pre><p>Converting between container types measured with different metrics has effect on the sensitivity of functions. See the documentation of <a href="../measuring_distance/#measuring-distance">container metrics</a> and page 19f of the <a href="https://arxiv.org/abs/1909.02481">duet paper</a> for details.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../types/">« Types</a><a class="docs-footer-nextpage" href="../../development_notes/updating_haskell/">Managing the two repositories »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.17 on <span class="colophon-date" title="Thursday 12 May 2022 12:38">Thursday 12 May 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
