<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Privacy functions · DiffPrivacyInference</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DiffPrivacyInference</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Overview</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../getting_started/installation/">Installation</a></li><li><a class="tocitem" href="../../getting_started/quick_guide/">Quick Guide</a></li></ul></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../01_sensitivity_functions/">Sensitivity functions</a></li><li class="is-active"><a class="tocitem" href>Privacy functions</a><ul class="internal"><li><a class="tocitem" href="#(\\varepsilon,-\\delta)-Differential-Privacy"><span>(<span>$\varepsilon$</span>, <span>$\delta$</span>)-Differential Privacy</span></a></li><li><a class="tocitem" href="#Additive-noise"><span>Additive noise</span></a></li><li><a class="tocitem" href="#Warning:-Floating-point-is-dangerous!"><span>Warning: Floating point is dangerous!</span></a></li><li><a class="tocitem" href="#Nice-properties-of-privacy-functions"><span>Nice properties of privacy functions</span></a></li><li><a class="tocitem" href="#Privacy-of-expressions"><span>Privacy of expressions</span></a></li></ul></li><li><a class="tocitem" href="../03_flux_dp/">Learning MNIST using <code>Flux.jl</code>, verified differentially private</a></li></ul></li><li><span class="tocitem">User Reference</span><ul><li><a class="tocitem" href="../../full_reference/overview/">Overview</a></li><li><a class="tocitem" href="../../full_reference/syntax/">Supported julia syntax</a></li><li><a class="tocitem" href="../../full_reference/annotations/">Annotations</a></li><li><a class="tocitem" href="../../full_reference/builtins/">Builtins</a></li><li><a class="tocitem" href="../../full_reference/black_boxes/">Black Boxes</a></li><li><a class="tocitem" href="../../full_reference/demutation/">Mutation rules</a></li><li><a class="tocitem" href="../../full_reference/scoping_rules/">Scoping rules</a></li><li><a class="tocitem" href="../../full_reference/measuring_distance/">Measuring Distance</a></li><li><a class="tocitem" href="../../full_reference/types/">Types</a></li><li><a class="tocitem" href="../../full_reference/constraints/">Constraints</a></li></ul></li><li><span class="tocitem">Development Notes</span><ul><li><a class="tocitem" href="../../development_notes/updating_haskell/">Managing the two repositories</a></li><li><a class="tocitem" href="../../development_notes/project_structure/">Project structure</a></li><li><a class="tocitem" href="../../development_notes/technical_description/">Technical description</a></li><li><a class="tocitem" href="../../development_notes/demutation_system/">Demutation system</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Privacy functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Privacy functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DiffMu/DiffPrivacyInference.jl/blob/master/docs/src/tutorial/02_privacy_functions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="privacy-functions"><a class="docs-heading-anchor" href="#privacy-functions">Privacy functions</a><a id="privacy-functions-1"></a><a class="docs-heading-anchor-permalink" href="#privacy-functions" title="Permalink"></a></h1><h2 id="(\\varepsilon,-\\delta)-Differential-Privacy"><a class="docs-heading-anchor" href="#(\\varepsilon,-\\delta)-Differential-Privacy">(<span>$\varepsilon$</span>, <span>$\delta$</span>)-Differential Privacy</a><a id="(\\varepsilon,-\\delta)-Differential-Privacy-1"></a><a class="docs-heading-anchor-permalink" href="#(\\varepsilon,-\\delta)-Differential-Privacy" title="Permalink"></a></h2><p>For metric spaces <span>$M,N$</span>, a map <span>$f:M\rightarrow N$</span> is <a href="https://en.wikipedia.org/wiki/Differential_privacy"><em>(<span>$\varepsilon$</span>, <span>$\delta$</span>)-differentially private</em></a> if for all <span>$x,y \in M$</span> with <span>$d_M(x,y) = 1$</span> and any set <span>$S\subseteq N$</span> we have</p><p class="math-container">\[Pr[f(x) \in S] \leq e^{\varepsilon} \cdot Pr[f(y) \in S] + \delta\]</p><p>Note that <code>f</code> being a probablilistic function is necessary for this definition to hold. Intuitively, the output distributions of an (<span>$\varepsilon$</span>, <span>$\delta$</span>)-differentially private function given neighboring inputs are hard to distinguish.</p><h2 id="Additive-noise"><a class="docs-heading-anchor" href="#Additive-noise">Additive noise</a><a id="Additive-noise-1"></a><a class="docs-heading-anchor-permalink" href="#Additive-noise" title="Permalink"></a></h2><p>It is possible to create an (<span>$\varepsilon$</span>, <span>$\delta$</span>)-differentially private function from a function with finite sensitivity by <a href="https://en.wikipedia.org/wiki/Additive_noise_mechanisms">adding noise drawn from a certain distribution</a>. We support two such mechanisms.</p><h3 id="Laplacian-Mechanism"><a class="docs-heading-anchor" href="#Laplacian-Mechanism">Laplacian Mechanism</a><a id="Laplacian-Mechanism-1"></a><a class="docs-heading-anchor-permalink" href="#Laplacian-Mechanism" title="Permalink"></a></h3><p>Let <span>$D$</span> be some space equipped with the <a href="../../full_reference/measuring_distance/#measuring-distance">discrete metric</a>. Given a function <span>$f:D\rightarrow \mathbb{R}^n$</span> that is<span>$s$</span>-sensitive in <span>$L2$</span> norm, for every <span>$\varepsilon\in(0,1)$</span> the Laplacian Mechanism</p><p class="math-container">\[\mathcal{M}_\text{Gauss}(f, \varepsilon)(x) = f(x) + \mathcal{Lap}^n\left(\mu = 0, b = \frac{s}{\varepsilon}\right)\]</p><p>yields an (<span>$\varepsilon$</span>, 0)-differentially private function, where <span>$\mathcal{Lap}^n(\mu, b)$</span> denotes an <span>$n$</span>-dimensional random variable drawn from the <a href="https://en.wikipedia.org/wiki/Laplace_distribution">Laplace distributioin</a>.</p><p>This mechansim is implemented in the <a href="../../full_reference/builtins/#DiffPrivacyInference.laplacian_mechanism-Tuple{Real, Real, Any}"><code>laplacian_mechanism</code></a> builtin function. There is a mutating implementation that does not make a copy of the value to be noised in <a href="../../full_reference/builtins/#DiffPrivacyInference.laplacian_mechanism!-Tuple{Real, Real, DMGrads}"><code>laplacian_mechanism!</code></a>.</p><h3 id="Gaussian-Mechanism"><a class="docs-heading-anchor" href="#Gaussian-Mechanism">Gaussian Mechanism</a><a id="Gaussian-Mechanism-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian-Mechanism" title="Permalink"></a></h3><p>Let <span>$D$</span> be some space equipped with the <a href="../../full_reference/measuring_distance/#measuring-distance">discrete metric</a>. Given a function <span>$f:D\rightarrow \mathbb{R}^n$</span> that is<span>$s$</span>-sensitive in <span>$L2$</span> norm, for every <span>$\delta\in(0,1)$</span> and <span>$\varepsilon\in(0,1)$</span> the Gaussian Mechanism</p><p class="math-container">\[\mathcal{M}_\text{Gauss}(f, \varepsilon, \delta)(x) = f(x) + \mathcal{N}^n\left(\mu = 0, \sigma^2 = \frac{2 \ln (1.25/\delta) \cdot s^2}{\varepsilon^2}\right)\]</p><p>yields an (<span>$\varepsilon$</span>, <span>$\delta$</span>)-differentially private function, where <span>$\mathcal{N}^n(\mu, \sigma^2)$</span> denotes an <span>$n$</span>-dimensional <a href="https://en.wikipedia.org/wiki/Normal_distribution">normally distributed</a> random variable.</p><p>This mechansim is implemented in the <a href="../../full_reference/builtins/#DiffPrivacyInference.gaussian_mechanism-Tuple{Real, Real, Real, Any}"><code>gaussian_mechanism</code></a> builtin function. There is a mutating implementation that does not make a copy of the value to be noised in <a href="../../full_reference/builtins/#DiffPrivacyInference.gaussian_mechanism!-Tuple{Real, Real, Real, DMGrads}"><code>gaussian_mechanism!</code></a>. Here&#39;s a function that achieves (0.1, 0.2)-differential privacy for it&#39;s integer argument by employing the Gaussian Mechanism:</p><pre><code class="language-julia hljs">julia&gt; typecheck_from_string(&quot;
       module Foo
       function foo(x::Integer) :: Priv()
          gaussian_mechanism(1,0.1,0.2,x)
       end
       end&quot;)

---------------------------------------------------------------------------
Type:
{
|   (Integer @ (0.1, 0.2)) -&gt;* Real
}

---------------------------------------------------------------------------</code></pre><h2 id="Warning:-Floating-point-is-dangerous!"><a class="docs-heading-anchor" href="#Warning:-Floating-point-is-dangerous!">Warning: Floating point is dangerous!</a><a id="Warning:-Floating-point-is-dangerous!-1"></a><a class="docs-heading-anchor-permalink" href="#Warning:-Floating-point-is-dangerous!" title="Permalink"></a></h2><p>The aforementioned definitions of differential privacy (and the related <a href="../01_sensitivity_functions/#sensitivity-functions">notion of sensitivity</a>) are defined on abstracet <a href="https://en.wikipedia.org/wiki/Metric_space">metric spaces</a>. Floating point numbers are an approximation of the real numbers, but in some respects differ fatally in their behaviour, especially when talking about probabilities, or when performing simple arithmetics on numbers of very different scale. Hence, the theoretical results don&#39;t really hold for floating point implementations of differentially private functions, as was <a href="https://www.microsoft.com/en-us/research/wp-content/uploads/2012/10/lsbs.pdf">spectacularily proven</a>. Mitigation for the flaws in naive random floating point sampling was provided by a <a href="https://arxiv.org/abs/2107.10138">2021 paper</a>, whose approach we use for our implementation of the additive noise mechanisms. We do not, however, provide sensitivity/privacy guarantees in case of overflow situations or rounding errors. These are <a href="https://cs-people.bu.edu/jiawenl/pdf/2020DP-FLPT.pdf">very hard to take into account</a> even in manual proofs and present a somewhat open problem.</p><h2 id="Nice-properties-of-privacy-functions"><a class="docs-heading-anchor" href="#Nice-properties-of-privacy-functions">Nice properties of privacy functions</a><a id="Nice-properties-of-privacy-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Nice-properties-of-privacy-functions" title="Permalink"></a></h2><p>There are nice theorems about properties of differentially private functions in the <a href="https://www.cis.upenn.edu/~aaroth/Papers/privacybook.pdf">Privacybook</a>. We are expecially interested in two of them.</p><h3 id="Robustness-to-Post-Processing"><a class="docs-heading-anchor" href="#Robustness-to-Post-Processing">Robustness to Post-Processing</a><a id="Robustness-to-Post-Processing-1"></a><a class="docs-heading-anchor-permalink" href="#Robustness-to-Post-Processing" title="Permalink"></a></h3><p>Proposition 2.1 claims that no matter what we do with the output of an (<span>$\varepsilon$</span>, <span>$\delta$</span>)-differentially private function, it stays (<span>$\varepsilon$</span>, <span>$\delta$</span>)-differentially private. Our typechecker knows this:</p><pre><code class="language-julia hljs">julia&gt; typecheck_from_string(&quot;
       module Foo
       function foo(x::Integer) :: Priv()
          gx = gaussian_mechanism(1,0.1,0.2,x)
          23 * gx + 42
       end
       end&quot;)

---------------------------------------------------------------------------
Type:
{
|   (Integer @ (0.1, 0.2)) -&gt;* Real
}

---------------------------------------------------------------------------</code></pre><h3 id="Advanced-Composition"><a class="docs-heading-anchor" href="#Advanced-Composition">Advanced Composition</a><a id="Advanced-Composition-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Composition" title="Permalink"></a></h3><p>Theorem 3.1 claims that composing an (<span>$\varepsilon$</span>, <span>$\delta$</span>)-differentially private function with itself <code>k</code> times yields an (<span>$\varepsilon$</span>&#39;, k<span>$\delta$</span> + <span>$\delta$</span>&#39;)-differentially private function for any <span>$\delta&#39;\in(0,1])$</span>, where <span>$\varepsilon&#39; = 2\sqrt{2k \ln(\frac{1}{\delta′})}\varepsilon$</span>. This can be expressed using a julia <code>for</code>-loop:</p><pre><code class="language-julia hljs">julia&gt; typecheck_from_string(&quot;
       module Foo
       function foo(x::Integer) :: Priv()
          y = 0.0
          for i in 1:5
             gx = gaussian_mechanism(1,0.1,0.2,x)
             y = y + 23 * gx + 42
          end
          y
       end
       end&quot;)

---------------------------------------------------------------------------
Type:
{
|   - Integer@(0.2⋅√(10.0⋅(0 - ln(s₁₀))), 1 + s₁₀)
|   --------------------------
|    -&gt;* Real
}
where
 - Variable s₁₀ can be chosen with type Real to be within (0,1]. Appeared in the privacy loop in none: line 5

---------------------------------------------------------------------------
Constraints:
constr₁₅ : s₁₀ ≤ 1,
constr₁₆ : 0 &lt; s₁₀</code></pre><h2 id="Privacy-of-expressions"><a class="docs-heading-anchor" href="#Privacy-of-expressions">Privacy of expressions</a><a id="Privacy-of-expressions-1"></a><a class="docs-heading-anchor-permalink" href="#Privacy-of-expressions" title="Permalink"></a></h2><p>The typechecker will discern between two kinds of expressions by assigning either a <a href="../01_sensitivity_functions/#sensitivity-functions">sensitivity</a> or a privacy to each variable therein. It can infer the privacy of all julia expressions that adhere to the <a href="../../full_reference/syntax/#syntax">supported syntax</a> and describe a differentially private randomized function. This means that it employs one of the two aforementioned mechanisms or calls a function that does.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../01_sensitivity_functions/">« Sensitivity functions</a><a class="docs-footer-nextpage" href="../03_flux_dp/">Learning MNIST using <code>Flux.jl</code>, verified differentially private »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.17 on <span class="colophon-date" title="Thursday 12 May 2022 12:57">Thursday 12 May 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
